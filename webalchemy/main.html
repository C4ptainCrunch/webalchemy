<!DOCTYPE html>
<html>
<body onload="init_communication()">
</body>
<script>
// the following files will be inserted here
--> reconnecting_ws.js
--> watch.js
--> cookie.js
--> vendor.js
--> comm.js
--> reconnection_overlay.js

init_communication = function() {
    ws = new ReconnectingWebSocket('ws://HOST:PORT/websocket');
    ws.onopen = function() {
       if (overlay_shown) {
        overlay_shown = false;
        document.body.innerHTML='';
       }
       message('hi, my ID is:'+get_cookie('webalchemy')+': and my tabid is:'+window.name+': and my vendor prefix is:'+vendor_prefix);
    };
    ws.onclose = function() {
      if (!overlay_shown) {
        document.body.appendChild(overlay);
        overlay_shown = true;
      }  
    }
    ws.onmessage = function (evt) {
       console.log('message received:')
       console.log(evt.data)
       eval(evt.data)
       message('done')
    };
}
</script>
</html> 



